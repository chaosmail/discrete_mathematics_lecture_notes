%%% EtherPad for Discrete Mathematics VO
%%% http://www.informatik-forum.at/showthread.php?104454-Notes-2013WS-VO_01
%%% Past pads:
%%%     * 2013-10-17: committed by patrikf
%%%     * 2013-10-18: committed by patrikf
%%%     * 2013-10-24: committed by patrikf
%%%     * 2013-10-25: committed by patrikf
%%%     * 2013-11-08: committed by neroburner

% Discrete Mathematics Lecture Notes 2013-11-21

\section{Generating Functions}

= tool for coping with combinatorial enumeration problems

sequence $(a_n)_{n≥0}$,
formal power series $\sum_{n≥0} a_n z^n$ = encoding of the sequence
(this is just a different way of writing down the sequence!)

two power series can be added
$\sum_{n≥0} (a_n + b_n) z^n$,

multiplied (Cauchy product)
$\sum_{n≥0}\sum_{k=0}^n a_k b{n-k} z^n$

if $b_0 ≠ 0$, you can also divide
\[
    \frac{
        \sum a_n z^n
    }{
        \sum b_n z^n
    } =
        \sum c_n z^n
\]

\[
    \sum_{n≥0} a_n t^n
    = \lim_{n \upto? a} \sum_{k=0}^{n} a_k z^k = *
\]

\textbf{If $(*)$ is convergent:}

Domain of convergence: disk with center (0,0) and the radius of convergence $R$
\[
    R = \frac1{\lim \sqrt[n]{|a_n|}}
    \in [0, \inf]
\]

\Theorem.
Let
\[
    f(z) = \sum a_n (z-z_0)^n,
    a_i\in \mathbb{C},
    R = \frac{1}{\lim \sqrt[n]{|a_n|}}
\].

Then
a)
\[
    |z - z_0| < R \implies
    \text{$f(z)$ absolutely convergent,
    i.e.
    $\sum |a_n| (z-z_0)^n$ convergent}
\]
b)
\[
    |z - z_0| > R \implies \text{$f(z) divergent}
\]

\Examples.
\begin{gather*}
    \sum_{n≥0} z^n =
        \frac1{1-z}\quad\text{for $|z|<1$, } R = 1 \\
    \sum_{n≥0} \frac{z^n}{n!} =
        e^z, R = \inf \\
    \sum_{n≥0} n! z^n, R = 0
\end{gather*}

Inside the disk of convergence, we even have \emph{uniform convergence} (allows interchange of limits).

\begin{gather*}
    \frac1{(1-z)^2}
    = (\frac1{1-z})'
    = (\sum_{n>=0} z^n)'
    = \sum_{n≥1} n z^{n-1}, \\
    
    \log\frac{1}{1-z} = \sum_{n≥1} \frac{z^n}{n}
\end{gather*}

\Theorem (Identity theorem for power series).
Let
\[
    f(z) = \sum_{n≥0} a_n (z-z_0)^n,
    \text{f(z) convergent for $|z-z_0| < \epsilon$}
\].
The coefficients $a_n$ are unique and satisfy
\[
    a_n = \frac{f^{(n)}(z_0)}{n!}.
\]
$f(z)$ is the \emph{Taylor series}.

\textbf{Corollary.}
\[
    \sum a_n (z-z_0)^n =
    \sum b_n (z-z_0)^n
    \text{for $|z-z_0| < \epsilon$}
    \implies
    a_n = b_n.
\]

Since $f(z)$ generates the sequence $(a_n)$ by continued differentiation and evaluation, we call $f(z)$ the \dt{generating function}. In particular,

\begin{align*}
\sum a_n z^n & \text{ordinary generating function} \\
\sum a_n \frac{z^n}{n!} & \text{exponential generating function.}
\end{align*}


\subsection*{Operations with Generating Functions}

sequence $(a_n)_{n≥0}$ corresponding to generating function
$\sum_{n≥0} a_n z^n = A(z)$,

$(b_n)_{n>=0} \text{corresponds to} B(z)$

\begin{align*}
    (\alpha a_n + \beta b_n)_{n≥0}
        &↔ \alpha A(z) + \beta B(z)
        &&\forall \alpha, \beta in \mathbb{C}
        \quad\text{(linearity)} \\
    (\sum_{k_0}^{n} a_k b_{n-k} )
        &↔ A(z) B(z),
        \text{in particular:}
        (\sum_{k=0}^n a_k)_{n≥0} ↔ \frac{1}{1-z} A(z)
\end{align*}

\Remark.
\begin{align*}
    \hat{A}(z) = \sum a_n \frac{z^n}{n1}, \\
    \hat{B}...
    
    (\sum_{k=0}^n n\choose k a_k b_{n-k})_{n≥0}
        ↔ \hat A(z)\hat B(z)
\end{align*}

\begin{align*}
    (a_n \gamma^n)_{n≥0} 
        &↔ A(\gamma z) \\
    (a_{n-1})_{n≥1}
        &↔ z A(z),
        (a_{n+1})_{n≥0} ↔ \frac{A(z)-a_0}z,
        EGF: (a_{n+1})_{n≥0} ↔ \hat A'(z) \\
    (n a_n)_{n≥0}
        &↔ z A'(z)
\end{align*}

\Example.
\[
    \sum_{n≥0} (-1)^n z^n
    = \frac{1}{1+z} \quad\text{for $|z| < 1$}.
\]

\Example.
\[
    \sum_{n≥0} n z^n
    = \frac{z}{(1-z)^2}
    = z (\frac1{1-z})'.
\]

\Example.
\[
    \sum_{n≥0} a\choose n z^n
    = (1+z)^\alpha
    \quad\forall\alpha\in\mathbb{C}
\]

\Example.
\begin{align*}
    a_n = \sum_{k≥0}^n k:\;
    \sum_n a_n z^n
    = \sum_{n≥0}
        \left(\sum_{k=0}^n k)\right) z^n
    = \sum_{n≥0} \left(\sum_{k=0}^n  k\cdot 1\right) z^n
        = \left( \sum_{n≥0} n z^n \right) \left( \sum_{n≥0} 1 \cdot z^n \right)
    = \frac{z}{(1-z)^3}
    = \frac12 z \left(\frac{1}{1-z}\right)''
    = \frac z2 \sum_{n≥2} n(n-1) z^{n-2}
    = \frac z2 \sum_{n≥0} n(n-1) z^{n-2}
    = \sum_{n≥0} \frac{(n+1)n}{2} z^n
    = \sum_{n≥0} {{n+1}\choose 2} z^n
\end{align*}

\Lemma.
\begin{gather*}
    \sum_{n≥0} {{n+k-1}\choose{k-1}} z^n
    = \frac1{(1-z)^k} \\
    (1 + z)^\alpha = \sum {a \choose n} z^n \\
\end{gather*}

Sketch of proof:
\[
    {{n+k-1}\choose {k-1}} = \ldots = (-1)^k{{-k}\choose n}
\]


\subsection*{Recurrence relations}

\Example.
Consider the Towers of Hanoi problem with $n$ disk. How many steps are needed to move the disks?
%\TODO{small graphic of Tower of Hanoi}

\begin{align*}
a_0 = 0
a_1 = 1

\text{For the $n+1$-th step, put $n$ disks to a temporary location, move the $n+1$-th disk, move the $n$ disks again.}

a_{n+1} = 2 a_n + 1, a_n = 2^n - 1
\end{align*}

A(z) = sum_{n \geq 0} a_n z^n

multiply both sides with z^n and sum up over n

\begin{align*}
\sum_{n≥0} a_{n+1} z^n &= 2 \sum_{n \geq 0} a_n z^{n+1} + \sum_{n\geq 0} z^{n+1} \\
A(z) - \not{a_0}    &= 2z A(z) + \frac{z}{1-z}
\end{align*}

\begin{align*}
A(z) &= 2 z A(z) + \frac{z}{1-z}
A(z) &= \frac{z}{(1-z)(1-2z)} 
    &= \frac{\alpha}{1-z} + \frac{\beta} {1-2z}
    &= \frac{-1}{1-z} + \frac{1}{1-2z} 
    &= -\sum_{n\geq 0} z^n + \sum_{n\geq 0} 2^n z^n
    &= \sum_{n\geq 0} (2^n-1) z^n
\end{align*}

\TODO{Check completeness of example}
\Example.
\[
    F_0 = 0, F_1 = 1, F_{n+2} = F_{n+1} + F_n \\
    F(z) &= \sum_{n≥0} F_n z^n : \\
    F(z) - \not{F_0} - F_1 z &= z \left F(t) - \not{F_0} \right + F(z)
        \implies F(z) = \frac{z}{1-z-z^2} \\
    F(z) = \frac{-z}{(z-z1) (z-z2)}, 
        \quad z_{1,2} = \frac{-1 \pm \sqrt{5}}{2} \\
    
    F(z) = \frac1{\sqrt{5}} \frac1{1 - \frac{1 + \sqrt{5}}{2} z} - ... \text{TODO (See Patrik's notes)} \\
    \implies F_n = \frac{1}{sqrt{5} \left( \left( \frac{1+ \sqrt 5}{2} \right) ^n - \left( frac{1-\sqrt{5}}{2} \right) ^n \right)
\]


In general:
\[
    a_{n+k} + q_1 a_{n+k-1} + \ldots + q_k a_n = 0
    \quad (*) for n ≥ 0

(*) is unique if the first k elements are given

$a_0, ..., a_{k-1}$ given, $q_i$ are given constants

A(z) = \sum_{n\geq 0} a_n z^n
\sum_{n\geq 0} a_n{n+k} z^{n+k} + q_1 \sum_{n\geq 0}  a_n{n+k-1}z^{n+k} + \ldots + q_k \sum_{n\geq 0} a_k z^{n+k} = 0


A(z) - a_0 - a_1 z - \ldots - a_{k-1} z^{k-1} + q_1 z ( A(z) - \sum_{i=0}^{k-z} a_i z^i ) + \ldots + q_k z^k A(z) = 0
A(z) = \frac{ p(z) }{ 1 + q_1 z + q_2 z^2 + \ldots + q_k z^k } = \frac{p(z)}{q(z)} = \frac{p(z)}{\prod_{i=1}^{r} (z - z_i)^{\lambda_i}}

% A(z) = \frac{p(x)}{1+ q_1 z + q_2 z^2 + \ldots q_k z^k}
% = \frac{p(z)}{q(z)} = \frac{p(z)}{\Pi_{i=1}^{

Use ansatz: \frac{p(z)}{q(z)} = \sum_{i=1}^{r} sum_{j=1}^{\lambda} \frac{A_{ij}}{(z-z_i=j}
= \frac{A_{11}}{z-z_n} + \frac{A_{12}}{(z-z_n)^2} + \ldots + 

\frac{}{(1-z)(1-2z) = \frac{\alpha}{1-z} + \frac{\beta}{1-2z} + \frac{\gamma}{(1-2z)^2} + \frac{\delta}{(1-2z)^3}

\TODO{check the previous formulas for completeness}
\TODO{Complement with Patrik's notes}

\Example.
\[
    a_{n+2} - 4 a_{n+1} - 4 a_n = 0 \quad n ≥ 0; a_0, a_1 given \\
    A(z) = \sum a_n z^n \\
    A(z) - a_0 - a_1 z - 4z (A(z)-a_0) + 4z^2 A(z) = 0 \\
    (1-4z + 4z^2) A(z) = a_0 + a_1 z - 4a_0 z \\
    A(z) = \frac{a_0 + (a1 - 4a_0)z}{1- 4z + + 4z^2} = \frac{a_0 + (a1 - 4a_0)z}{(1-2z)^2}
    = \frac{C}{1-2z} + \frac{D}{(1-2z)^2} \\
    \implies a_0 + (a_1 - 4a_0)z = C (1-2z) + D \\
    [z^0]: a_0 = C+D \\
    [z^1]: a_1 - 4a_0 = -C \\
    \implies C, D \\
    
    \ldots = C * \sum 2^n z^n + D * \sum_n (n+1) *2^n z^n 
    = \sum_n \left(2^n *C + (n+1)* 2^n D\right) z^n
    = \sum_n \left(a_n) z^n
\]

\TODO{add inhomogeneous recurrence relation to above example, i.e., $0$ on the rhs of the initial equation is replaced by $f(n)$}



\subsection*{Unlabelled Combinatorial Structures}

\Example.
Binary tree (complete), (without cycles, plane, rooted, either no further children (external nodes, leaves) or 2 children (internal nodes))

\TODO{ graph of complete Binary tree}

Binary tree is a plane structure
\TODO{ graph of mirrored trees, annotated as unequal}

$a_n$ = number of binary trees with $n$ internal nodes

If there are n internal nodes, then there are n+1 leaves. The number of vertices in a binary tree is always odd ($n + (n+1)$). 

We try to describe the btree recursively:

Binary tree with size $n+1$,
left child has size $k$ and the right child has size $n-k$. 
$k$ in range $0$ to $n$

\begin{align*}
    a_0 &= 1 \\
    a_{n+1} &= \sum_{k=0}^{n} a_k a_{n-k}
        \quad | \cdot z^{n+1} | \sum \\
    A(z) - 1 &= z A(z)^2
        \quad \text{(Cauchy-Product)} \\
    A(z) &= \frac{1 \pm \sqrt{1-4z}}{2z}
        &= \frac{1 \pm (1-4z)^{\frac1{2}}{2z} \\
    \text{$+$ is not a viable option, so we use the $-$} \\
    ...
    (1 + z)^\alpha &= \sum_n {\alpha \choose n} z^n \\
    &= - \sum_{n\geq 0} \frac{\frac12 (-\frac12) (-\frac32) \ldots (\frac12 - n+1))}{n!} * (-4)^n z^n
    \sum_{n\geq 0} \frac{1}{n+1} {2n \choose n} z^n
    \text{Catalan numbers}
\end{align*}

% Up next:
% \textbf{Generalisation?}
% A(z) = 1 + z A(z) ^ 2











